@model ThreeAmigos_ExpenseManagement.ViewModels.ExpenseFormViewModel
@{
    ViewBag.Title = "Expense Management System | Process Expense";
    Layout = "~/Views/Shared/_EM_LayoutPage.cshtml";    
}

@using (Html.BeginForm("ProcessExpenses", "Accounts", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)


    <div class="panel panel-primary">

        <div class="panel-heading">
            <h3 class="panel-title">View Reports</h3>
        </div>

        @foreach (var ExpenseReport in Model.ExpenseReports)
        {	
  
            <table class="table">
                <tr class="info">
                    <th>Report Date: @ExpenseReport.CreateDate</th>
                    <th>Consultant :@ExpenseReport.CreatedBy.Fullname</th>
                    <th>Department:@ExpenseReport.Department.DepartmentName</th>
                    <th>Status : @ExpenseReport.Status</th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
                <tr>
                    <th></th>
                    <th>Expense Date</th>
                    <th>Location</th>
                    <th>Description</th>
                    <th>File Name</th>
                    <th>Amount (AUD)</th>
                </tr>

                @foreach (var ExpenseItem in ExpenseReport.ExpenseItems)
                {
                    <tr>
                        <td></td>
                        <td>@ExpenseItem.ExpenseDate</td>
                        <td>@ExpenseItem.Location</td>
                        <td>@ExpenseItem.Description</td>
                        <td>@if (@ExpenseItem.ReceiptFileName != null && @ExpenseItem.ReceiptFileName != "")
                               {
                                   <a href="/Receipts/@ExpenseItem.ReceiptFileName" target="_blank">
                                   <img src="~/Images/img_pdf_icon.png" /></a>
                               }
                         </td>                        
                        <td>@ExpenseItem.AudAmount </td>
                    </tr> 
                }
            </table>
 
            <div>
                @Html.ActionLink(
                    linkText: "Approve",
                    actionName: "ProcessExpenses",
                    controllerName: "Accounts",
                    routeValues: new { itemid = ExpenseReport.ExpenseId, act = "Approve" },
                    htmlAttributes: new { @class = "btn btn-success" }
                    )
                &nbsp;
                &nbsp;
                @Html.ActionLink(
                    linkText: "Reject",
                    actionName: "ProcessExpenses",
                    controllerName: "Accounts",
                    routeValues: new { itemid = ExpenseReport.ExpenseId, act = "Reject" },
                    htmlAttributes: new { @class = "btn btn-success" }
                )
            </div>
    
   
        }
    </div>
}

